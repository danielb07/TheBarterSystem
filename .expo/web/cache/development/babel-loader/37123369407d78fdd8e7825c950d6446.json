{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"C:\\\\Users\\\\barraud\\\\Desktop\\\\WhiteHatJR\\\\the-barter-system\\\\components\\\\CustomSidebarMenu.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { DrawerItems } from 'react-navigation-drawer';\nimport { Avatar } from 'react-native-elements';\nimport * as ImagePicker from 'expo-image-picker';\nimport firebase from 'firebase';\nimport db from \"../config\";\n\nvar CustomSidebarMenu = function (_React$Component) {\n  _inherits(CustomSidebarMenu, _React$Component);\n\n  var _super = _createSuper(CustomSidebarMenu);\n\n  function CustomSidebarMenu() {\n    var _this;\n\n    _classCallCheck(this, CustomSidebarMenu);\n\n    _this = _super.call(this);\n\n    _this.selectPicture = function _callee() {\n      var _await$ImagePicker$la, cancelled, uri;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n                mediaTypes: ImagePicker.MediaTypeOptions.All,\n                allowsEditing: true,\n                aspect: [4, 3]\n              }));\n\n            case 2:\n              _await$ImagePicker$la = _context.sent;\n              cancelled = _await$ImagePicker$la.cancelled;\n              uri = _await$ImagePicker$la.uri;\n\n              if (!cancelled) {\n                _this.uploadImage(uri, _this.state.userId);\n              }\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.uploadImage = function _callee2(uri, name) {\n      var response, blob, ref;\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(fetch(uri));\n\n            case 2:\n              response = _context2.sent;\n              _context2.next = 5;\n              return _regeneratorRuntime.awrap(response.blob());\n\n            case 5:\n              blob = _context2.sent;\n              ref = firebase.storage().ref().child('user_profile' + name);\n              return _context2.abrupt(\"return\", ref.put(blob).then(function (response) {\n                return _this.fetchImage(name);\n              }));\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.fetchImage = function (name) {\n      var storageRef = firebase.storage().ref().child('user_profile' + name);\n      storageRef.getDownloadURL().then(function (url) {\n        _this.setState({\n          image: url\n        });\n      }).catch(function () {\n        _this.setState({\n          image: '#'\n        });\n      });\n    };\n\n    _this.state = {\n      image: '#',\n      userId: firebase.auth().currentUser.email,\n      name: '',\n      docId: ''\n    };\n    return _this;\n  }\n\n  _createClass(CustomSidebarMenu, [{\n    key: \"getUserProfile\",\n    value: function getUserProfile() {\n      var _this2 = this;\n\n      db.collection('user').where(\"email\", \"==\", this.state.userId).get().then(function (snapshot) {\n        snapshot.forEach(function (doc) {\n          _this2.setState({\n            \"name\": doc.data().first_name + \" \" + doc.data().last_name\n          });\n        });\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.fetchImage();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(View, {\n        style: {\n          flex: 1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 7\n        }\n      }, React.createElement(Avatar, {\n        rounded: true,\n        source: {\n          uri: this.state.image\n        },\n        size: \"xlarge\",\n        onPress: function onPress() {},\n        icon: {\n          name: 'user',\n          type: 'font-awesome'\n        },\n        showEditButton: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 9\n        }\n      }), React.createElement(Text, {\n        style: {\n          fontWeight: 100,\n          fontSize: 20,\n          paddingTop: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 9\n        }\n      }, this.state.name), React.createElement(DrawerItems, _extends({}, this.props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 9\n        }\n      })), React.createElement(View, {\n        style: {\n          flex: 1,\n          justifyContent: 'flex-end',\n          paddingBottom: 30\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 9\n        }\n      }, React.createElement(TouchableOpacity, {\n        style: {\n          justifyContent: 'center',\n          padding: 10,\n          height: 30,\n          width: '100%'\n        },\n        onPress: function onPress() {\n          _this3.props.navigation.navigate('WelcomeScreen');\n\n          firebase.auth().signOut();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }\n      }, React.createElement(Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }\n      }, \"Logout\"))));\n    }\n  }]);\n\n  return CustomSidebarMenu;\n}(React.Component);\n\nexport { CustomSidebarMenu as default };","map":{"version":3,"sources":["C:/Users/barraud/Desktop/WhiteHatJR/the-barter-system/components/CustomSidebarMenu.js"],"names":["React","DrawerItems","Avatar","ImagePicker","firebase","db","CustomSidebarMenu","selectPicture","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","aspect","cancelled","uri","uploadImage","state","userId","name","fetch","response","blob","ref","storage","child","put","then","fetchImage","storageRef","getDownloadURL","url","setState","image","catch","auth","currentUser","email","docId","collection","where","get","snapshot","forEach","doc","data","first_name","last_name","flex","type","fontWeight","fontSize","paddingTop","props","justifyContent","paddingBottom","padding","height","width","navigation","navigate","signOut","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {View, Text,TouchableOpacity} from 'react-native';\r\nimport { DrawerItems} from 'react-navigation-drawer'\r\nimport { Avatar } from 'react-native-elements'\r\nimport * as ImagePicker from 'expo-image-picker'\r\n\r\nimport firebase from 'firebase';\r\nimport db from '../config'\r\n\r\nexport default class CustomSidebarMenu extends React.Component{\r\n  constructor(){\r\n    super();\r\n    this.state ={\r\n      image:'#',\r\n      userId:firebase.auth().currentUser.email,\r\n      name:'',\r\n      docId:''\r\n\r\n    }\r\n  }\r\n  selectPicture = async() =>{\r\n    const {cancelled, uri } = await ImagePicker.launchImageLibraryAsync({\r\n      mediaTypes:ImagePicker.MediaTypeOptions.All,\r\n      allowsEditing:true,\r\n      aspect:[4,3],\r\n\r\n    });\r\n    if(!cancelled){\r\n      this.uploadImage(uri, this.state.userId)\r\n    }\r\n  }\r\n\r\n  uploadImage = async(uri, name) =>{\r\n    let response = await fetch(uri);\r\n    let blob = await response.blob();\r\n\r\n    var ref = firebase.storage().ref().child('user_profile'+name);\r\n\r\n    return ref.put(blob).then((response)=>this.fetchImage(name))\r\n  }\r\n\r\n  fetchImage = (name) =>{\r\n    var storageRef = firebase.storage().ref().child('user_profile'+name);\r\n\r\n    storageRef.getDownloadURL().then((url)=>{\r\n      this.setState({image:url})\r\n    })\r\n    .catch(()=>{\r\n      this.setState({image:'#'})\r\n    })\r\n  }\r\n\r\n  getUserProfile(){\r\n    db.collection('user').where(\"email\",\"==\", this.state.userId).get()\r\n            .then((snapshot)=>{\r\n                snapshot.forEach((doc) => {\r\n                this.setState({\r\n                    \"name\" : doc.data().first_name + \" \" + doc.data().last_name\r\n                })\r\n            });\r\n        })\r\n  }\r\n\r\n  componentDidMount(){\r\n    this.fetchImage();\r\n  }\r\n\r\n  render(){\r\n    return(\r\n      <View style={{flex:1}}>\r\n        <Avatar\r\n          rounded\r\n          source={{\r\n            uri:this.state.image\r\n          }}\r\n          \r\n          size=\"xlarge\"\r\n          onPress={()=>{\r\n            \r\n          }}\r\n          icon={{name: 'user', type: 'font-awesome'}}\r\n          showEditButton\r\n          />\r\n        <Text style={{fontWeight:100, fontSize:20, paddingTop:10}}>\r\n          {this.state.name}\r\n        </Text>\r\n        <DrawerItems {...this.props}/>\r\n        <View style={{flex:1,justifyContent:'flex-end',paddingBottom:30}}>\r\n          <TouchableOpacity style={{justifyContent:'center',padding:10,height:30,width:'100%'}}\r\n          onPress = {() => {\r\n              this.props.navigation.navigate('WelcomeScreen')\r\n              firebase.auth().signOut()\r\n          }}>\r\n            <Text>Logout</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n    )\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}